
define(['jquery', 'config'], function($, config) {

	var loadJson = function(tourId) {
		return {
			"id":                       "59705a4d4cedfd004b22302d",
			"created":                  1500535373000,
			"modified":                 1500536085514,
			"name":                     "gräfe 78 we 20",
			"itemID":                   "59705a4d4cedfd004b22302e",
			"agentID":                  "596f5ecb46e0fb004a5d5edc",
			"limitedAccess":            false,
			"grantAccessAutomatically": false,
			"status":                   1,
			"panoramas":                [
				{
					"filename":      "srv_c7fxnlv900.JPG",
					"fileUrls":      {
						"SMALL":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/150-images/srv_c7fxnlv900.JPG?v=1500535444423",
						"FULL":          "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/srv_c7fxnlv900.JPG?v=1500535444423",
						"HD1080":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1080-images/srv_c7fxnlv900.JPG?v=1500535444423",
						"ORIGINAL_PATH": "http://localhost:8086/static/srv_c7fxnlv900.JPG?v=1500535444423",
						"HD1606":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1606-images/srv_c7fxnlv900.JPG?v=1500535444423",
						"THUMB":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/thumb-images/srv_c7fxnlv900.JPG?v=1500535444423"
					},
					"name":          "Küche",
					"plan":          3,
					"limitedAccess": false,
					"isFirst":       true,
					"status":        6,
					"source":        "GALLERY",
					"hotspots":      [],
					"attachments":   [
						{
							"ID":             "gulizyiaar",
							"xPos":           -16.509058270802427,
							"yPos":           1.0851572547835167,
							"name":           "Wohnzimmer",
							"attachmentType": "HOTSPOT",
							"linkedRoom":     "srv_u9181e4447.JPG"
						}
					]
				},
				{
					"filename":      "srv_ygh98x3w30.JPG",
					"fileUrls":      {
						"SMALL":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/150-images/srv_ygh98x3w30.JPG?v=1500535481139",
						"FULL":          "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/srv_ygh98x3w30.JPG?v=1500535481139",
						"HD1080":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1080-images/srv_ygh98x3w30.JPG?v=1500535481139",
						"ORIGINAL_PATH": "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/original-images/srv_ygh98x3w30.JPG?v=1500535481139",
						"HD1606":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1606-images/srv_ygh98x3w30.JPG?v=1500535481139",
						"THUMB":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/thumb-images/srv_ygh98x3w30.JPG?v=1500535481139"
					},
					"name":          "Schlafzimmer",
					"plan":          3,
					"limitedAccess": false,
					"isFirst":       false,
					"status":        6,
					"source":        "GALLERY",
					"hotspots":      [],
					"attachments":   [
						{
							"ID":             "twoyeruwel",
							"xPos":           -144.88317757009347,
							"yPos":           11.77570093457944,
							"name":           "Badezimmer",
							"attachmentType": "HOTSPOT",
							"linkedRoom":     "srv_nig682l490.JPG"
						}
					]
				},
				{
					"filename":      "srv_nig682l490.JPG",
					"fileUrls":      {
						"SMALL":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/150-images/srv_nig682l490.JPG?v=1500535513918",
						"FULL":          "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/srv_nig682l490.JPG?v=1500535513918",
						"HD1080":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1080-images/srv_nig682l490.JPG?v=1500535513918",
						"ORIGINAL_PATH": "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/original-images/srv_nig682l490.JPG?v=1500535513918",
						"HD1606":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1606-images/srv_nig682l490.JPG?v=1500535513918",
						"THUMB":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/thumb-images/srv_nig682l490.JPG?v=1500535513918"
					},
					"name":          "Badezimmer",
					"plan":          3,
					"limitedAccess": false,
					"isFirst":       false,
					"status":        6,
					"source":        "GALLERY",
					"hotspots":      [],
					"attachments":   [
						{
							"ID":             "etoqhatqfs",
							"xPos":           0.8411214953271129,
							"yPos":           6.939252336448591,
							"name":           "Schlafzimmer",
							"attachmentType": "HOTSPOT",
							"linkedRoom":     "srv_ygh98x3w30.JPG"
						}
					]
				},
				{
					"filename":      "srv_u9181e4447.JPG",
					"fileUrls":      {
						"SMALL":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/150-images/srv_u9181e4447.JPG?v=1500536152014",
						"FULL":          "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/srv_u9181e4447.JPG?v=1500536152014",
						"HD1080":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1080-images/srv_u9181e4447.JPG?v=1500536152014",
						"ORIGINAL_PATH": "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/original-images/srv_u9181e4447.JPG?v=1500536152014",
						"HD1606":        "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/1606-images/srv_u9181e4447.JPG?v=1500536152014",
						"THUMB":         "https://images-virtualtours.immobilienscout24.de/items/residea_m/59705a4d4cedfd004b22302e/Tour/thumb-images/srv_u9181e4447.JPG?v=1500536152014"
					},
					"name":          "Wohnzimmer",
					"plan":          3,
					"limitedAccess": false,
					"isFirst":       false,
					"status":        6,
					"source":        "GALLERY",
					"hotspots":      [],
					"attachments":   [
						{
							"ID":             "zhondafzqx",
							"xPos":           -150.98130841121494,
							"yPos":           -2.733644859813087,
							"attachmentType": "HOTSPOT",
							"linkedRoom":     "srv_nig682l490.JPG"
						}
					]
				}
			]
		}
	};
	return function(tourId, callback) {
		$.ajax
		({
			type: "GET",
			url: "https://virtualtours.immobilienscout24.de/rest/v1/tours/tour?internalID="+tourId,
			dataType: 'json',
			async: false,
			headers: {
				"Authorization": config.immoviewer_auth_header
			},
			success: function (data){
				var panos = data.panoramas.map(function(panorama) {
					// noinspection JSUnusedGlobalSymbols
					return {
						tourPano:  panorama,
						location:  {
							pano:        panorama.filename,
							description: panorama.name
						},
						links:     panorama.attachments.map(function(attachment) {
							return {
								heading: (attachment.xPos + 90),
								pano:    attachment.linkedRoom
							};
						}),
						// The text for the copyright control.
						copyright: 'Imagery (c) 2017 Immobilien Scout24 GmbH',
						// The definition of the tiles for this panorama.
						tiles:     {
							//tileSize: new google.maps.Size(2000, 1000),
							//worldSize: new google.maps.Size(2000, 1000),
							// The heading in degrees at the origin of the panorama
							// tile set.
							tileSize: new google.maps.Size(10000, 5000),
							worldSize: new google.maps.Size(10000, 5000),

							centerHeading: 105,
							getTileUrl:    function() {
								return panorama.fileUrls.ORIGINAL_PATH
							}
						}
					};
				});
				callback(panos);
			}
		});

	}
});